"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _export(target,all){for(var name in all)Object.defineProperty(target,name,{enumerable:true,get:all[name]})}_export(exports,{AuthMiddleware:function(){return AuthMiddleware},authMiddleware:function(){return authMiddleware}});const _jsonwebtoken=_interop_require_default(require("jsonwebtoken"));function _interop_require_default(obj){return obj&&obj.__esModule?obj:{default:obj}}class AuthMiddleware{verifyJWT(req,res,next){try{var _req_header;const token=(_req_header=req.header("Authorization"))===null||_req_header===void 0?void 0:_req_header.replace("Bearer ","");if(!token){throw new Error("Unauthorized request")}const user=_jsonwebtoken.default.verify(token,process.env.JWT_SECRET);if(!user||user.user_id===null){return res.status(500).json({message:"Invalid access token"})}req.user=user;next()}catch(error){return res.status(401).json({message:error.message||"Invalid access token",code:401})}}}const authMiddleware=new AuthMiddleware;